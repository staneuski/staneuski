/*--------------------------------*- C++ -*----------------------------------*\
  =========                 |
  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
   \\    /   O peration     | Website:  https://openfoam.org
    \\  /    A nd           | Version:  dev
     \\/     M anipulation  |
-------------------------------------------------------------------------------
Description
    Caches and writes mass flux

\*---------------------------------------------------------------------------*/

type            coded;
libs            ( "libutilityFunctionObjects.so" );

executeControl  writeTime;
writeControl    writeTime;

rhoField        rho;
UField          U;

result          rhoPhi;

codeInclude
#{
    #include "fvcFlux.H"
#};

codeFields
#{
    fields.append($<word>rhoField);
    fields.append($<word>UField);
#};

codeExecute
#{
    const surScalarField& rho =
        mesh().lookupObject<volScalarField>($<word>rhoField);
    const volVectorField& U =
        mesh().lookupObject<volVectorField>($<word>UField);

    store($<word>result, linearInterpolate(rho*U) & mesh().Sf());
#};

codeWrite
#{
    return writeObject($<word>result);
#};

// ************************************************************************* //
